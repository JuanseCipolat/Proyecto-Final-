<!DOCTYPE html>
<html>
<head>
    <title>Productos</title>
    <link rel="stylesheet" href="/stylesheets/frecuenciagamer.css">
</head>
<body>
    <div class="content">
        <h1>Productos</h1>

        <h2>A침adir Nuevo Producto</h2>
        <form action="/admin/productos" method="post" enctype="multipart/form-data">
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" name="nombre" required><br><br>
            
            <label for="descripcion">Descripci칩n:</label>
            <textarea id="descripcion" name="descripcion" required></textarea><br><br>
            
            <label for="imagen">Imagen:</label>
            <input type="file" id="imagen" name="imagen"><br><br>

            <label for="stock">Stock:</label>
            <input type="number" id="stock" name="stock" required><br><br>
            
            <label for="precio">Precio:</label>
            <input type="number" id="precio" name="precio" required><br><br>
            
            <button type="submit">A침adir Producto</button>
        </form>

        <h2>Lista de Productos</h2>
        <ul>
            {{#each productos}}
            <li>
                <img src="{{this.imagen}}" alt="Imagen de {{this.nombre}}" width="100"><br>
                <strong>{{this.nombre}}</strong> - {{this.descripcion}} - Stock: {{this.stock}} - Precio: ${{this.precio}}
                <form action="/admin/productos/{{this.id}}?_method=DELETE" method="post" style="display:inline;">
                    <button type="submit">Eliminar</button>
                </form>
                <button onclick="editProducto('{{this.id}}', '{{this.nombre}}', '{{this.descripcion}}', '{{this.imagen}}', '{{this.stock}}', '{{this.precio}}')">Editar</button>
            </li>
            {{/each}}
        </ul>

        <a href="/admin">Volver al Admin</a>

        <div id="editForm" style="display:none;">
            <h2>Editar Producto</h2>
            <form id="editProductoForm" action="" method="post" enctype="multipart/form-data">
                <input type="hidden" id="editId" name="_method" value="PUT">
                <label for="editNombre">Nombre:</label>
                <input type="text" id="editNombre" name="nombre" required><br><br>
                
                <label for="editDescripcion">Descripci칩n:</label>
                <textarea id="editDescripcion" name="descripcion" required></textarea><br><br>
                
                <label for="editImagen">Imagen:</label>
                <input type="file" id="editImagen" name="imagen"><br><br>
                
                <label for="editStock">Stock:</label>
                <input type="number" id="editStock" name="stock" required><br><br>

                <label for="editPrecio">Precio:</label>
                <input type="number" id="editPrecio" name="precio" required><br><br>
                
                <button type="submit">Guardar Cambios</button>
                <button type="button" onclick="cancelEdit()">Cancelar</button>
            </form>
        </div>
    </div>

    <script>
        function editProducto(id, nombre, descripcion, imagen, stock, precio) {
            document.getElementById('editForm').style.display = 'block';
            document.getElementById('editProductoForm').action = '/admin/productos/' + id;
            document.getElementById('editId').value = id;
            document.getElementById('editNombre').value = nombre;
            document.getElementById('editDescripcion').value = descripcion;
            document.getElementById('editStock').value = stock;
            document.getElementById('editPrecio').value = precio;
        }

        function cancelEdit() {
            document.getElementById('editForm').style.display = 'none';
        }
    </script>
</body>
</html>
